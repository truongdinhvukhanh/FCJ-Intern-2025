# Worklog - NgÃ y 16/07/2025

## ğŸ“… ThÃ´ng tin cÆ¡ báº£n

- **NgÃ y**: 16/07/2025
- **Thá»©**: Thá»© TÆ°
- **Tuáº§n thá»±c táº­p**: Tuáº§n thá»© 10
- **Thá»i gian lÃ m viá»‡c**: 13:00 - 17:00
- **Mood**: ğŸ˜Š Ráº¥t vui vÃ¬ Ä‘Ã£ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» truy cáº­p OpenSearch Dashboard sau nhiá»u ná»— lá»±c.

## ğŸ¯ Má»¥c tiÃªu ngÃ y hÃ´m nay

- [x]  Má»¥c tiÃªu 1: TÃ¬m cÃ¡ch fix váº¥n Ä‘á» vá» quyá»n khi káº¿t ná»‘i Ä‘áº¿n OpenSearch Dashboard
- [ ]  Má»¥c tiÃªu 2: Thiáº¿t láº­p Kinesis Firehose Stream vá»›i Destination lÃ  OpenSearch vÃ  backup vÃ o S3 Bucket (sáº½ thá»±c hiá»‡n sau khi OpenSearch Dashboard truy cáº­p Ä‘Æ°á»£c)

## ğŸ’¼ CÃ´ng viá»‡c Ä‘Ã£ thá»±c hiá»‡n

### 1. Fix váº¥n Ä‘á» vá» quyá»n khi káº¿t ná»‘i Ä‘áº¿n OpenSearch Dashboard â±ï¸ 13:00 - 17:00

- **MÃ´ táº£**:
    - RÃ  soÃ¡t láº¡i IAM Role cá»§a EC2 Bastion vÃ  OpenSearch Domain Policy má»™t cÃ¡ch cáº©n tháº­n.
    - Táº¡m thá»i Ä‘áº·t OpenSearch Domain Policy lÃ  "Allow all" Ä‘á»ƒ loáº¡i trá»« hoÃ n toÃ n cÃ¡c váº¥n Ä‘á» vá» quyá»n á»Ÿ cáº¥p domain.
    - Truy cáº­p vÃ o OpenSearch Dashboard (lÃºc nÃ y Ä‘Ã£ thÃ nh cÃ´ng do policy "Allow all").
    - Tiáº¿n hÃ nh mapping quyá»n cho IAM Role cá»§a Bastion Host trong Security configuration cá»§a OpenSearch Dashboard (vÃ­ dá»¥: táº¡o role `analyst` trong OpenSearch vÃ  gÃ¡n IAM role cá»§a Bastion vÃ o Ä‘Ã³).
    - Siáº¿t láº¡i quyá»n trong OpenSearch Domain Policy Ä‘á»ƒ chá»‰ cho phÃ©p IAM Role cá»§a Bastion truy cáº­p vÃ o cÃ¡c action cáº§n thiáº¿t
- **Káº¿t quáº£**: Bastion Host Ä‘Ã£ truy cáº­p thÃ nh cÃ´ng vÃ o OpenSearch Dashboard vá»›i quyá»n Ä‘Æ°á»£c cáº¥p thÃ´ng qua IAM Role vÃ  mapping trong OpenSearch.
- **Tools/Tech**:
    - Amazon OpenSearch Service
    - Amazon EC2
    - Amazon Q
- **Links**: [GitHub commits, documentation, screenshots]

## ğŸ“š Kiáº¿n thá»©c há»c Ä‘Æ°á»£c

### ğŸ”§ Technical Skills

- **AWS Services**: Náº¯m vá»¯ng hÆ¡n vá» cÆ¡ cháº¿ xÃ¡c thá»±c vÃ  á»§y quyá»n trong Amazon OpenSearch Service, Ä‘áº·c biá»‡t lÃ  sá»± káº¿t há»£p giá»¯a IAM policies (táº¡i cáº¥p dá»‹ch vá»¥), OpenSearch Domain Access Policies (táº¡i cáº¥p domain) vÃ  Fine-grained access control (bÃªn trong Dashboard, mapping IAM role vá»›i cÃ¡c vai trÃ² cá»§a OpenSearch nhÆ° `all_access`, `read_only`).
- **DevOps**: Cáº£i thiá»‡n ká»¹ nÄƒng troubleshooting cÃ¡c váº¥n Ä‘á» phá»©c táº¡p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  quyá»n truy cáº­p trong mÃ´i trÆ°á»ng cloud. Hiá»ƒu rÃµ quy trÃ¬nh kiá»ƒm tra vÃ  siáº¿t cháº·t quyá»n sau khi xÃ¡c minh truy cáº­p.
- **Architecture**: Hiá»ƒu sÃ¢u hÆ¡n vá» cÃ¡c lá»›p báº£o máº­t khi truy cáº­p má»™t dá»‹ch vá»¥ trong VPC thÃ´ng qua Bastion Host vÃ  cÃ¡ch cÃ¡c lá»›p Ä‘Ã³ tÆ°Æ¡ng tÃ¡c Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n.

### ğŸ’¡ Concepts & Theory

- **New Concepts**:
    - **Fine-grained access control (FGAC)** trong OpenSearch Service: Cho phÃ©p quáº£n lÃ½ quyá»n truy cáº­p á»Ÿ cáº¥p Ä‘á»™ Index, Document, Field, vÃ  tháº­m chÃ­ lÃ  trÃªn Dashboard.
    - **Internal Users/Roles** trong OpenSearch vÃ  cÃ¡ch chÃºng Ä‘Æ°á»£c **mapped** vá»›i IAM users/roles.
    - Quy trÃ¬nh **debug quyá»n truy cáº­p** báº±ng cÃ¡ch ná»›i lá»ng táº¡m thá»i Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nguyÃªn nhÃ¢n gá»‘c rá»…, sau Ä‘Ã³ siáº¿t cháº·t láº¡i.
- **Best Practices**:
    - **LuÃ´n báº¯t Ä‘áº§u vá»›i quyá»n háº¡n tháº¥p nháº¥t** vÃ  nÃ¢ng dáº§n lÃªn. (BÃ i há»c tá»« viá»‡c pháº£i "Allow all" rá»“i siáº¿t láº¡i).
    - **PhÃ¢n tÃ¡ch trÃ¡ch nhiá»‡m** rÃµ rÃ ng giá»¯a IAM (cáº¥p quyá»n AWS) vÃ  Fine-grained access control (cáº¥p quyá»n trong OpenSearch).
    - Sá»­ dá»¥ng **Bastion Host** káº¿t há»£p vá»›i **SSH Tunneling** lÃ  má»™t phÆ°Æ¡ng phÃ¡p an toÃ n Ä‘á»ƒ truy cáº­p cÃ¡c tÃ i nguyÃªn trong VPC.
- **Industry Knowledge**: Quy trÃ¬nh chuáº©n trong viá»‡c **xá»­ lÃ½ sá»± cá»‘ báº£o máº­t**: xÃ¡c Ä‘á»‹nh váº¥n Ä‘á», cÃ´ láº­p nguyÃªn nhÃ¢n, Ã¡p dá»¥ng giáº£i phÃ¡p táº¡m thá»i (náº¿u cáº§n), kiá»ƒm tra, vÃ  cuá»‘i cÃ¹ng lÃ  Ã¡p dá»¥ng giáº£i phÃ¡p bá»n vá»¯ng.

### ğŸ¤ Soft Skills

- **Problem Solving**: ÄÃ£ kiÃªn trÃ¬ vÃ  thÃ nh cÃ´ng trong viá»‡c giáº£i quyáº¿t má»™t váº¥n Ä‘á» phá»©c táº¡p, Ä‘Ã²i há»i sá»± phÃ¢n tÃ­ch sÃ¢u sáº¯c vÃ  thá»­ nghiá»‡m nhiá»u phÆ°Æ¡ng Ã¡n.
- **Learning**: TÃ­ch cá»±c tÃ¬m kiáº¿m thÃ´ng tin tá»« nhiá»u nguá»“n vÃ  tá»•ng há»£p kiáº¿n thá»©c Ä‘á»ƒ Ä‘Æ°a ra giáº£i phÃ¡p hiá»‡u quáº£.
- **Time Management**: Máº·c dÃ¹ máº¥t khÃ¡ nhiá»u thá»i gian, nhÆ°ng Ä‘Ã£ táº­p trung vÃ  giáº£i quyáº¿t triá»‡t Ä‘á»ƒ váº¥n Ä‘á», giÃºp má»Ÿ khÃ³a cÃ¡c cÃ´ng viá»‡c tiáº¿p theo.

## ğŸš§ KhÃ³ khÄƒn vÃ  giáº£i phÃ¡p

### Váº¥n Ä‘á» 1: **Káº¿t ná»‘i Ä‘áº¿n OpenSearch Dashboard bá»‹ tá»« chá»‘i**

- **MÃ´ táº£**: Ban Ä‘áº§u, dÃ¹ Ä‘Ã£ cáº¥u hÃ¬nh IAM Role vÃ  Security Group, váº«n khÃ´ng thá»ƒ truy cáº­p OpenSearch Dashboard. Lá»—i "Denied" liÃªn tá»¥c xuáº¥t hiá»‡n.
- **Impact**: NgÄƒn cáº£n viá»‡c tiáº¿n hÃ nh cÃ¡c bÆ°á»›c tiáº¿p theo nhÆ° thiáº¿t láº­p Kinesis Firehose vÃ  kiá»ƒm tra dá»¯ liá»‡u.
- **Root Cause**: NguyÃªn nhÃ¢n chÃ­nh lÃ  do thiáº¿u cáº¥u hÃ¬nh **Fine-grained access control** bÃªn trong OpenSearch Dashboard Ä‘á»ƒ **mapping IAM Role cá»§a Bastion Host vá»›i má»™t vai trÃ² cÃ³ quyá»n truy cáº­p Dashboard** (vÃ­ dá»¥: `all_access` hoáº·c má»™t vai trÃ² tÃ¹y chá»‰nh). Chá»‰ cáº¥p quyá»n qua IAM Policy vÃ  Domain Policy lÃ  chÆ°a Ä‘á»§ náº¿u khÃ´ng cÃ³ mapping nÃ y.
- **Solution**:
    1. **Äáº·t OpenSearch Domain Policy thÃ nh "Allow all"** táº¡m thá»i Ä‘á»ƒ truy cáº­p Dashboard.
    2. **ÄÄƒng nháº­p vÃ o OpenSearch Dashboard** báº±ng master user (khi táº¡o domain) hoáº·c báº±ng IAM Role cÃ³ quyá»n admin náº¿u Ä‘Ã£ cáº¥u hÃ¬nh.
    3. Äiá»u hÆ°á»›ng Ä‘áº¿n **Security** -> **Roles** vÃ  **Role mappings**.
    4. **Táº¡o má»™t role má»›i** (hoáº·c sá»­ dá»¥ng `all_access`) vÃ  **mapping IAM Role cá»§a Bastion Host** vÃ o role Ä‘Ã³.
    5. **Siáº¿t cháº·t láº¡i OpenSearch Domain Policy** Ä‘á»ƒ chá»‰ cho phÃ©p cÃ¡c quyá»n cáº§n thiáº¿t (`es:ESHttpGet`, `es:ESHttpPost`, v.v.) tá»« IAM Role cá»§a Bastion.
- **Result**: ÄÃ£ truy cáº­p thÃ nh cÃ´ng vÃ o OpenSearch Dashboard thÃ´ng qua Bastion Host, giáº£i quyáº¿t Ä‘Æ°á»£c rÃ o cáº£n lá»›n nháº¥t cá»§a ngÃ y.
- **Lesson**: Hiá»ƒu rÃµ cÃ¡c lá»›p báº£o máº­t trong AWS lÃ  cá»±c ká»³ quan trá»ng, Ä‘áº·c biá»‡t khi cÃ¡c dá»‹ch vá»¥ cÃ³ cÆ¡ cháº¿ xÃ¡c thá»±c riÃªng biá»‡t ngoÃ i IAM (nhÆ° Fine-grained access control cá»§a OpenSearch). ÄÃ´i khi, viá»‡c "ná»›i lá»ng" táº¡m thá»i cÃ³ kiá»ƒm soÃ¡t cÃ³ thá»ƒ giÃºp xÃ¡c Ä‘á»‹nh nguyÃªn nhÃ¢n gá»‘c rá»… nhanh hÆ¡n.

## ğŸ’­ Reflection & Insights

### What went well today?

- **HoÃ n thÃ nh má»¥c tiÃªu quan trá»ng**: ÄÃ£ thÃ nh cÃ´ng trong viá»‡c giáº£i quyáº¿t váº¥n Ä‘á» truy cáº­p OpenSearch Dashboard, má»Ÿ khÃ³a cho cÃ¡c bÆ°á»›c cÃ´ng viá»‡c tiáº¿p theo.
- **Há»c há»i sÃ¢u sáº¯c**: CÃ³ Ä‘Æ°á»£c kiáº¿n thá»©c thá»±c táº¿ ráº¥t giÃ¡ trá»‹ vá» báº£o máº­t OpenSearch vÃ  ká»¹ thuáº­t debugging Ä‘a lá»›p.
- **KiÃªn trÃ¬ vÃ  khÃ´ng bá» cuá»™c**: DÃ¹ gáº·p khÃ³ khÄƒn ngÃ y hÃ´m qua, Ä‘Ã£ tiáº¿p tá»¥c tÃ¬m hiá»ƒu vÃ  cuá»‘i cÃ¹ng Ä‘Ã£ tÃ¬m ra giáº£i phÃ¡p.

### What could be improved?

- **NghiÃªn cá»©u trÆ°á»›c ká»¹ hÆ¡n**: Láº½ ra nÃªn tÃ¬m hiá»ƒu sÃ¢u hÆ¡n vá» cÆ¡ cháº¿ **Fine-grained access control** cá»§a OpenSearch ngay tá»« Ä‘áº§u Ä‘á»ƒ trÃ¡nh máº¥t thá»i gian debugging.
- **Táº­n dá»¥ng Amazon Q hiá»‡u quáº£ hÆ¡n**: CÃ³ thá»ƒ há»i Amazon Q chi tiáº¿t hÆ¡n vá» cÃ¡c trÆ°á»ng há»£p xÃ¡c thá»±c phá»©c táº¡p Ä‘á»ƒ cÃ³ hÆ°á»›ng Ä‘i nhanh hÆ¡n.

### Key Insights

- **Multi-layered security is key**: Báº£o máº­t trÃªn AWS lÃ  sá»± káº¿t há»£p cá»§a nhiá»u lá»›p (Network, IAM, Resource Policies, vÃ  cáº£ cÆ¡ cháº¿ xÃ¡c thá»±c ná»™i bá»™ cá»§a tá»«ng dá»‹ch vá»¥). Hiá»ƒu rÃµ tá»«ng lá»›p lÃ  Ä‘iá»u cáº§n thiáº¿t.
- **Debugging lÃ  má»™t ká»¹ nÄƒng cáº§n thiáº¿t**: Kháº£ nÄƒng phÃ¢n tÃ­ch váº¥n Ä‘á», loáº¡i trá»« nguyÃªn nhÃ¢n, vÃ  tÃ¬m kiáº¿m giáº£i phÃ¡p lÃ  ká»¹ nÄƒng vÃ´ giÃ¡ Ä‘á»‘i vá»›i má»™t ká»¹ sÆ° Ä‘Ã¡m mÃ¢y.
- **Quan trá»ng lÃ  xÃ¡c Ä‘á»‹nh Ä‘Ãºng "Root Cause"**: Khi Ä‘Ã£ biáº¿t nguyÃªn nhÃ¢n gá»‘c rá»… (thiáº¿u mapping quyá»n trong FGAC), giáº£i phÃ¡p trá»Ÿ nÃªn rÃµ rÃ ng.

### Questions & Curiosities

- CÃ³ cÃ¡ch nÃ o Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a viá»‡c mapping quyá»n trong OpenSearch FGAC báº±ng IaC (vÃ­ dá»¥: Terraform) thay vÃ¬ thao tÃ¡c thá»§ cÃ´ng qua Dashboard khÃ´ng?
- CÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng **Amazon Cognito** Ä‘á»ƒ xÃ¡c thá»±c OpenSearch Dashboard khÃ¡c vá»›i viá»‡c sá»­ dá»¥ng IAM nhÆ° tháº¿ nÃ o, vÃ  khi nÃ o nÃªn dÃ¹ng cÃ¡i nÃ o?
- Liá»‡u viá»‡c **siáº¿t cháº·t quyá»n** OpenSearch Domain Policy cÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ AWS khÃ¡c (nhÆ° Kinesis Firehose) khi chÃºng cá»‘ gáº¯ng gá»­i dá»¯ liá»‡u Ä‘áº¿n OpenSearch khÃ´ng?

## ğŸ“‹ Káº¿ hoáº¡ch ngÃ y mai

### Priority Tasks

- [ ]  **High**: Thiáº¿t láº­p Kinesis Firehose Stream vá»›i Destination lÃ  OpenSearch vÃ  backup vÃ o S3 Bucket
- [ ]  **Medium**: Kiá»ƒm tra xem dá»¯ liá»‡u cÃ³ Ä‘áº¿n Ä‘Ã­ch nhÆ° dá»± Ä‘á»‹nh khÃ´ng

### Learning Goals

- [ ]  NghiÃªn cá»©u ká»¹ vá» cáº¥u hÃ¬nh Kinesis Firehose, Ä‘áº·c biá»‡t lÃ  Source (Direct Put), Destination (OpenSearch), vÃ  Data Transformation (Lambda function).
- [ ]  Äá»c tÃ i liá»‡u vá» cÃ¡c IAM permissions cáº§n thiáº¿t cho Kinesis Firehose Ä‘á»ƒ gá»­i dá»¯ liá»‡u Ä‘áº¿n OpenSearch vÃ  S3.
- [ ]  TÃ¬m hiá»ƒu cÃ¡ch táº¡o index pattern trong OpenSearch Dashboard Ä‘á»ƒ xem dá»¯ liá»‡u Ä‘Æ°á»£c ingested tá»« Firehose.

### Meetings & Deadlines

- [ ]  HoÃ n thÃ nh project trÆ°á»›c ngÃ y 20/07

## ğŸ“Š Self Assessment

### Productivity

- **Score**: [8/10]
- **Reason**: Máº·c dÃ¹ chá»‰ lÃ m viá»‡c ná»­a ngÃ y, Ä‘Ã£ giáº£i quyáº¿t Ä‘Æ°á»£c má»™t váº¥n Ä‘á» lá»›n vÃ  quan trá»ng, giÃºp má»Ÿ khÃ³a cÃ¡c cÃ´ng viá»‡c tiáº¿p theo.
- **Improvement**: Náº¿u cÃ³ thá»ƒ, nÃªn dÃ nh trá»n váº¹n má»™t ngÃ y Ä‘á»ƒ cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c nhiá»u má»¥c tiÃªu hÆ¡n.

### Learning

- **Score**: [9/10]
- **New Knowledge**: Kiáº¿n thá»©c sÃ¢u sáº¯c vá» báº£o máº­t OpenSearch, Ä‘áº·c biá»‡t lÃ  Fine-grained access control.
- **Application**: Ãp dá»¥ng thÃ nh cÃ´ng cÃ¡c ká»¹ thuáº­t debugging vÃ  cáº¥u hÃ¬nh phá»©c táº¡p.

### Overall Satisfaction

- **Score**: [8/10]
- **Highlights**: VÆ°á»£t qua thá»­ thÃ¡ch lá»›n nháº¥t trong tuáº§n, cáº£m tháº¥y tá»± tin hÆ¡n vá»›i kiáº¿n thá»©c vá» AWS Security.
- **Areas for Growth**: Tiáº¿p tá»¥c phÃ¡t triá»ƒn ká»¹ nÄƒng tá»± há»c vÃ  giáº£i quyáº¿t váº¥n Ä‘á», Ä‘á»“ng thá»i cáº£i thiá»‡n kháº£ nÄƒng Æ°á»›c lÆ°á»£ng thá»i gian cho cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p.

## ğŸ“ Attachments & Links

### Code & Projects

- [Notion](https://www.notion.so/Workshop-223c3d0326c8809e8078e153862ef46d?pvs=21)

---

**ğŸ“ Notes for tomorrow:**
[Ghi chÃº quan trá»ng cho ngÃ y mai]

**ğŸ¯ Week Progress:** Day 3/5 completed.

---

*Worklog created by: TrÆ°Æ¡ng ÄÃ¬nh VÅ© Khanh*

*Next review: 17/07/2025*